<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8" />
<title>Networking Worksheet</title>
<meta name="author" content="RAMontante"/>
<meta name="date" content="2016-12-22"/>
<base href="https://montcs.bloomu.edu"/>
<style type="text/css">
@import url("/css/generic.css");
@import url("/css/pagefmt.css");
@import url("/css/w3cvalid.css");

body {
    font-size:12pt;
    width:8.5in;
    margin:0;
    padding:0.50in;
}

h3 { margin-bottom:1ex; margin-top:4ex;padding-top:0.5ex;border-top: 1px solid #ddd; }

h4 { margin-bottom:1ex; }

ol { margin-top:1ex; }
ol li { margin-top:0ex; margin-bottom:3ex; padding-top:4px; border-top:1px dotted #999;}
ul li {margin-top:0.5ex;margin-bottom:1.5ex; padding-top:4px;}

ol.compact li {margin-bottom:1.0ex;width:90%;}

img {
    margin:0;
    padding:0;
    border:1px solid #000;
}

.code,
code {
    padding-left:2px;padding-right:2px;margin-bottom:1.5ex;
    font-family: monospace;
    font-size:100%;
}
div.code {width:25em;page-break-inside:avoid;}

.code, code,
pre {background:#e0e0e0}

div#title {
    float:left;
    font-size: 14pt;
    font-weight: bold;
    margin: 0;
    padding: 0;
    border:1px solid red;
}
div#title p {
    width: 3.45in;
    margin: 0ex 0em 0ex 2em;
    text-indent: -2em;
    padding: 0;
}

div#SigBlock {
    float:left;
    width:3in;height:0.75in;
    vertical-align:top;
    border:1px solid #000;padding:1em;
}

.answerline {
    display:inline-block;
    width:1in;
    border-bottom:1px solid #000;
}

.fancyfont {
    color:#a33;
}

</style>
<script type="text/javascript" src="/js/utilities.js"></script>

</head><body class="">

<div id="content">
<div id="title">
  <p class="">Networking</p>
  <p>VM-setup Worksheet</p>
</div><!-- title -->
<div id="SigBlock" class="HIDE"><span class="">Name:</span></div>
<!-- ==================================================================== -->

<h1>Setting up Virtual Machines &mdash; part a</h1>

<img class="floatright width300" src="/VM-LAN/VM-network.0d.svg" alt="two VMs" />

In this worksheet you will set up a Virtual Machine running Windows 7.
This machine will have a simple user account called "virt", and with password "virt" so that nobody forgets their account or password.
<p>
This VM takes a longish time to install.
Once the Windows VM is installing, you can begin the next worksheet, which installs the second VM (a Linux one).
This may speed things up somewhat.
</p>

<p>
Some terminology:
</p>
<ul class=""><li>
    The actual computer that you're using is called the <em>physical host</em>.
</li><li>
    It will run a program called a <em>virtual machine manager (VM manager)</em>; we will be using the VirtualBox VM manager.
    The VM manager provides the Internet gateway.
</li><li>
    Within it, you will configure and run some <em>virtual machines</em> or <em>VMs</em>, each one running an operating system (such as Windows 7 or Linux).
</li><li>
    Your first VMs are <em>clients</em>; later on you will add two router VMs as well.
</li><li>
    Your physical host has an IP address that looks like: <strong>192.168.141.<span class="fancyfont">x</span></strong>; the value <span class="fancyfont">x</span> is your virtual network's <em>system number</em>, and will be used repeatedly to identify your VMs.
    Your system number should be a value somewhere between 80 and 126.
</li></ul>

<h2>Set up and Start the VirtualBox VM Manager</h2>
<ol><li>
    First open a terminal on your physical host.
</li><li>
    Run the <code class="prompt2 boxed">ifconfig</code> command.
    Note your IP (inet) address <span class="HIDE">and MAC (HWaddr or ether) address</span> for later reference.
    It should look like <tt>148.137.141.</tt><strong class="fancyfont">???</strong> where the "<strong class="fancyfont">???</strong>" varies from host to host.
    <em>Remember</em> the number <strong class="fancyfont">???</strong> &mdash; this is your network's system number, and you will use it repeatedly in configuring your network.
    <div class="HIDE width400 height200 boxed"> </div>

</li><li class="">
    <p>
    If you haven't already, use the <code class="prompt2 boxed">mountmadhome</code> command to mount your "M:" drive as the "MadHome" directory in your home directory.
    You will need about 20GB free on your "MadHome" drive.
    </p>

</li><li>
    Run the command <code class="prompt2 boxed">virtualbox</code> from the command line, or find the link from the start menu.

</li><li>
    In the Oracle VM Virtualbox Manager window, click on:
    <strong>File &rarr; Preferences &rarr; General</strong>

</li><li class="">
    Set the Default Machine Folder to be a folder in MadHome.
    You should create a folder to hold VMs (and other files) for this course.

</li><li class="">
    Click on
    <strong>File &rarr; Preferences &rarr; Network</strong>
    </p>
</li><li>
    In the "<u>N</u>AT Networks" tab, click the "Plus" icon on the right.
    <p>
    You should see a new named network, perhaps "NatNetwork".
    Whatever the name is, remember it.
    </p>

</li><li>
    Click on "OK".
</li></ol>

<hr/>

<h2>Windows VM</h2>
<!-- Takes about 40 minutes... -->
<ol><li>
    Click on "New" from the VM manager window.
    <ul class=""><li>
    Name this machine "<strong>Win7-<span class="fancyfont">&lt;system-number&gt;</span></strong>", where "<strong class="fancyfont">&lt;system-number&gt;</strong>" is the last number of your physical host's IP address (<em>e.g.</em> 106 or 118).
    <br/>
    Set the "Type" and "Version" as Windows 7 (use 64-bit), and click on "Next &gt;".
    </li><li>
    Set the Memory at 512 MB (&frac12; GB), and click on "Next &gt;".
    </li><li>
    Check "Create a virtual hard drive now", and click on "Create".
    </li><li>
    Check "VDI (VirtualBox Disk Image)", and click on "Next &gt;".
    </li><li>
    Check "Dynamically allocated", and click on "Next &gt;".
    </li><li>
    Set the virtual hard drive size to about 12 GB, and click on "Create".
    </li></ul>

</li><li>
    Select your Windows VM, and click on <strong>Settings</strong>.
    <ul class=""><li>
        Click on <strong>Storage</strong> on the left.
    </li><li>
        Click on the "Empty" item in the Storage tree in the middle.
    </li><li>
        On the far right, click on the circular icon (bluish, looks kind of like a CD or DVD).
    </li><li>
        Click on "Choose virtual optical disk file..."
        and browse to "<strong>Computer &rarr; / &rarr; /iso-files</strong>".
    </li><li>
        Double-click (or Open) the "Win_Pro_7_64bit.iso" file.

    </li><li class="">
        Click on <strong>Network</strong> (on the left).
    </li><li class="">
        The Adapter 1 tab, near the middle, is (probably) currently attached to "NAT".
        Change it to be attached to "NAT network".
        <p>
        Select the same name that was added to the "<u>N</u>AT Networks" earlier.
        </p>

    </li><li>
        Click <strong>OK</strong> in the lower right corner.
    </li></ul>

</li><li>
    Select your Windows VM, and click on the <strong>Start</strong> icon (or just double-click on the Windows VM).
    <ul class=""><li>
        Click on "Install now".
    </li><li>
        Let the installation run.
        If you get a dialog box about "NULL audio backend" just click on "OK".
    </li><li>
        Accept the license terms.
    </li><li>
        Choose a <em><b>Custom (advanced)</b></em> installation.
    </li></ul>

</li><li>
    <img class="floatright width400" src="/VM-LAN/remove-disk-from-virtual-drive-Win.png" alt="remove disk" />
    When it's done, restart your new Windows VM.
    <ul class=""><li>
        While it's finishing its installation, click on the "Devices" menu (above the Windows screen).
    </li><li>
        Choose "Optical Drives".
    </li><li>
        Click on "Remove disk from virtual drive".
    </li></ul>

</li><li>
    Let Windows restart.
    <ul class=""><li>
        Create a user named "virt", with password "virt" (the default machine name is acceptable).
        The easiest password hint is to simply enter "virt" again.
    </li><li>
        Select "Ask me later" for the security settings.
    </li><li>
        Select "Eastern Time" for the time and date settings.
    </li><li>
        (<em>Important:</em>) Select "Work network" for the current location.
    </li></ul>

</li><li>
    Login to Windows if necessary, using account "virt" and password "virt".
    <ul class=""><li>
        Click on "Start -&gt; All Programs -&gt; Accessories".
    </li><li>
        Right-click on "Command Prompt" and choose "Pin to Taskbar", or else drag the icon onto the desktop.
        This will make it more convenient to start command prompts in the future.
    </li><li>
        Double-click on the command-prompt icon to start a command shell.
    </li><li>
        <img class="floatright width450" src="/VM-LAN/ipconfig.png" alt="ipconfig" />
        In the shell, run the command <code class="prompt2 boxed">ipconfig</code>.
        <p>
        Find your VM's IP address &mdash; it will be on a line labeled "IPv4 Address", and is a value like "2.0.2.14".
        </p>
    </li><li>
        Run the command <code class="prompt2 boxed">ping 4.2.2.2</code> to determine whether you're connected to the Internet.
        (You should be.)
    </li><li>
        Run the command <code class="prompt2 boxed">ping google.com</code> to determine whether your VM can resolve domain names.
        (This should work also.)
    </li></ul>

</li><li>
    Select "Start-Button -&gt; Control Panel -&gt; System and Security".
    <ol class="compact"><li>
        Choose "Windows Firewall" (on the right).
    </li><li class="">
        Choose "Allow a program or feature through Windows Firewall".
    </li><li class="">
        Click on "Change settings".
    </li><li class="">
         Check "File and Printer Sharing" on.
    </li></ol>
    This should let inbound "pings" get through.

</li></ol>

<h4>Make your VM resize-able</h4>
<ol><li>
    Click on the "Devices" menu (above the Windows screen) again.
    <p>
    Choose "Insert Guest Additions CD image".
    </p>
</li><li>
    If the CD doesn't autostart, then...
    <ol class=""><li>
        Click the Windows Start button in the VM, and enter the command "computer".
    </li><li>
        Double-click the "CD drive (D:) VirtualBox Guest Additions".
    </li></ol>
</li><li>
    Run the "VBoxWindowsAdditions.exe" application.
    Accept the defaults, and install the software.
</li><li>
    Restart Windows.
    <ul class=""><li>
        While it's restarting, click on the "Devices" menu (above the Windows screen).
    </li><li>
        Choose "Optical Drives".
    </li><li>
        Click on "Remove disk from virtual drive".
    </li></ul>
</li><li>
    You should now be able to use "Menu -&gt; Control Panel -&gt; Display" to resize the window to be larger &mdash; try 1024x768 or 1280x1024.
    <p>
    Alternatively, you can just drag and drop the corner of the window to resize it.
    </p>
</li></ol>

<hr/>

<!-- ............................................................. -->

<h3>
You've set up your Windows VM as a network <em>client</em>.
</h3>
